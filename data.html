<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="Form.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
 
</head>
<body>
    <div style="display: flex;" > 
    <div style="display: flex;margin:10px;padding: 10px;"> <a href="./index.html" class="but1"  >back </a></div>
    <div style="display: flex;margin:10px;padding: 10px;"><h2 id="usernamen" style="display:none"></h2></div>
    <div style="display: flex;margin:10px;padding: 10px;"> <input type="button" id="fix" style="display: none;"  value=""></div>
    <div style="display: flex;margin:10px;padding: 10px;"><input id="inpu" placeholder="password "style="padding-left: 20px;padding-right: 20px;" class="form2" type="password"></div>
    <div style="display: flex;margin:10px;padding: 10px;"> <button class="but" style="padding-left: 20px;padding-right: 20px;"id="veri" >get all data</button></div>
    <div style="display: flex;margin:10px;padding: 10px;"><button class="but" style="padding-left: 20px;padding-right: 20px;"id="verii" >save data</button></div>
    
   
</div>
  <div class="container mt-3">

 
     <table class="table table-dark">
        <thead>
           <th>iddd</th>
            <th>unique_id </th>
            <th>khata</th>
            <th>nam / father_name</th>
            <th>block</th>
            <th>phone_number</th>
            <th>udeshya</th>
            <th>byaj_dar</th>
            <th>sector</th>
        </thead>
        
      
 

        <tbody id="tbody1"></tbody>

    </table>

  </div>  
<script type="module" >
var tbody=document.getElementById('tbody1');
var stdNo=0;
function AddItemToTable(UniqueId,nam,father_name,block,khata,udeshya,byaj_dar,sector,phone_number){


let trow=document.createElement("tr");
let td1=document.createElement("td");
let td2=document.createElement("td");
let td3=document.createElement("td");
let td4=document.createElement("td");
let td5=document.createElement("td");
let td6=document.createElement("td");
let td7=document.createElement("td");
let td8=document.createElement("td");

td1.innerHTML=++stdNo;
td2.innerHTML=parseInt(UniqueId);
td3.innerHTML=khata;
td4.innerHTML=nam+"/"+father_name;
td5.innerHTML=block;
td6.innerHTML=phone_number;
td7.innerHTML=udeshya; 
td8.innerHTML=byaj_dar;

trow.appendChild(td1);
trow.appendChild(td2);
trow.appendChild(td3);
trow.appendChild(td4);
trow.appendChild(td5);
trow.appendChild(td6);
trow.appendChild(td7);
trow.appendChild(td8);

tbody.appendChild(trow);
 
}

 
function AddAllItemToTable(datee){ 
datee.forEach(element=>{ 
AddItemToTable(element.UniqueId,element.nam,element.father_name,element.block,element.khata,element.udeshya,element.byaj_dar,element.sector,element.phone_number);
 });
} // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-app.js";
    // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries
 // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyBaAXmU3KU2EiMRUinqq9svxQtI65wwxpA",
    authDomain: "formdata-b7401.firebaseapp.com",
    databaseURL: "https://formdata-b7401-default-rtdb.firebaseio.com",
    projectId: "formdata-b7401",
    storageBucket: "formdata-b7401.appspot.com",
    messagingSenderId: "44569804899",
    appId: "1:44569804899:web:ffe6af4efafd322d09b856"
  };
  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
 import {
    getFirestore,doc,getDoc,getDocs,onSnapshot,collection ,query, orderBy, limit,collectionGroup
 }
 from "https://www.gstatic.com/firebasejs/9.14.0/firebase-firestore.js";
//  import { query, orderBy, limit } from "firebase/firestore"; 
 const db = getFirestore();
async function GetAllDataOnce(){
//   .collection("date")
// .orderBy("khata", "asc")
// const colref=collection(db,'date');
// const q=query(colref,);
  //  const querySnapshot = await getDocs(collection(db,"date"));//.collection("formdata").orderBy("date", "asc")
    var students=[]; 
     
    //  querySnapshot.forEach(doc => {
    //     students.push(doc.data());
    // });
  
    console.log(students.length);
const museums = query(collection(db, 'date'), orderBy('UniqueId'));
const querySnapshot = await getDocs(museums);
querySnapshot.forEach(doc => {
        students.push(doc.data());
    });

  
   

     console.log(students.length);
    AddAllItemToTable(students);
}
const userdata = await getDocs(collection(db,"user")); //.collection("formdata").orderBy("date", "asc")
              
              var user=[]; 
               userdata.forEach(doc => {
                  user.push(doc.data());
              }); 
//add eventlistner
document.getElementById('veri').addEventListener('click' ,function(){
  for(var i=0;i<user.length;i++)
if(document.getElementById('inpu').value==user[i].password){
  document.getElementById('inpu').value="";   document.getElementById('tbody1').innerHTML="";
  stdNo=0;
document.getElementById('usernamen').innerHTML=user[i].name;
document.getElementById('usernamen').style.display="block";

GetAllDataOnce();
document.getElementById('verii').addEventListener('click',function(){
document.getElementById('veri').accessKey='p';


})
  // window.onload=GetAllDataOnce;

}
else alert("you are not authorised...")

})

</script>


</body>
</html>